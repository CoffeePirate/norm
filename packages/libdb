#!/bin/bash

fetch_source http://ftp.de.debian.org/debian/pool/main/d/db/db_5.1.29.orig.tar.gz 42dc96c71873c7fde543c916ed866cadee6fa51d
fetch_debian http://ftp.de.debian.org/debian/pool/main/d/db/db_5.1.29-5.debian.tar.gz 85cadf2cbcfee9df053ff6ede42081538ca7a8fc

## TODO: create macros to configure outside of 'dist' subdir but inside source tree
do_undebian
pushd_src
mkdir -p build
cd build
../dist/configure --enable-compat185 --mandir=$PREFIX/share/man --disable-java --prefix=$PREFIX
do_make
do_install
popd

fetch_source http://ftp.de.debian.org/debian/pool/main/d/db1-compat/db1-compat_2.1.3.orig.tar.gz
fetch_debian http://ftp.de.debian.org/debian/pool/main/d/db1-compat/db1-compat_2.1.3-16.debian.tar.gz

do_undebian
pushd_src
do_make
install -m 755 db_dump185/db_dump185 $PREFIX/bin/
install -m 755 libdb1.so.2 $PREFIX/lib/libdb1-2.2.5.so
ln -s libdb1-2.2.5.so $PREFIX/lib/libdb1.so.2
ln -s libdb1-2.2.5.so $PREFIX/lib/libdb1.so
popd

log_success
